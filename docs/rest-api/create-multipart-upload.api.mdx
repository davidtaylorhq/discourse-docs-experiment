---
id: create-multipart-upload
title: "Creates a multipart external upload"
description: "Creates a multipart upload in the external storage provider, storing"
sidebar_label: "Creates a multipart external upload"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: docs/rest-api/discourse-api-documentation
custom_edit_url: null
hide_send_button: true
---

import ApiTabs from "@theme/ApiTabs";
import DiscriminatorTabs from "@theme/DiscriminatorTabs";
import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import SecuritySchemes from "@theme/ApiExplorer/SecuritySchemes";
import MimeTabs from "@theme/MimeTabs";
import ParamsItem from "@theme/ParamsItem";
import ResponseSamples from "@theme/ResponseSamples";
import SchemaItem from "@theme/SchemaItem";
import SchemaTabs from "@theme/SchemaTabs";
import Markdown from "@theme/Markdown";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";

<h1 className={"openapi__heading"}>Creates a multipart external upload</h1>

<MethodEndpoint method={"post"} path={"/uploads/create-multipart.json"}></MethodEndpoint>



Creates a multipart upload in the external storage provider, storing
a temporary reference to the external upload similar to /get-presigned-put.

You must have the correct permissions and CORS settings configured in your
external provider. We support AWS S3 as the default. See:

https://meta.discourse.org/t/-/210469#s3-multipart-direct-uploads-4.

An external file store must be set up and `enable_direct_s3_uploads` must
be set to true for this endpoint to function.



## Request

<MimeTabs className={"openapi-tabs__mime"}><TabItem label={"application/json"} value={"application/json-schema"}><details style={{}} className={"openapi-markdown__details mime"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-mime"}><h3 className={"openapi-markdown__details-summary-header-body"}>Body</h3></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"upload_type"} required={true} schemaName={"string"} qualifierMessage={"**Possible values:** [`avatar`, `profile_background`, `card_background`, `custom_emoji`, `composer`]"} schema={{"type":"string","enum":["avatar","profile_background","card_background","custom_emoji","composer"]}}></SchemaItem><SchemaItem collapsible={false} name={"file_name"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","example":"IMG_2021.jpeg"}}></SchemaItem><SchemaItem collapsible={false} name={"file_size"} required={true} schemaName={"integer"} qualifierMessage={undefined} schema={{"type":"integer","description":"File size should be represented in bytes.","example":4096}}></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>metadata</strong><span className={"openapi-schema__name"}> object</span></span></summary><div style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"sha1-checksum"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"The SHA1 checksum of the upload binary blob. Optionally be provided and serves as an additional security check when later processing the file in complete-external-upload endpoint."}}></SchemaItem></div></details></SchemaItem></ul></details></TabItem></MimeTabs><div><div><ApiTabs label={undefined} id={undefined}><TabItem label={"200"} value={"200"}><div>

external upload initialized

</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"key"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"The path of the temporary file on the external storage service.","example":"temp/site/uploads/default/12345/67890.jpg"}}></SchemaItem><SchemaItem collapsible={false} name={"external_upload_identifier"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"The identifier of the multipart upload in the external storage provider. This is the multipart upload_id in AWS S3.","example":"84x83tmxy398t3y._Q_z8CoJYVr69bE6D7f8J6Oo0434QquLFoYdGVerWFx9X5HDEI_TP_95c34n853495x35345394.d.ghQ"}}></SchemaItem><SchemaItem collapsible={false} name={"unique_identifier"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"A unique string that identifies the external upload. This must be stored and then sent in the /complete-multipart and /batch-presign-multipart-parts endpoints.","example":"66e86218-80d9-4bda-b4d5-2b6def968705"}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"key\": \"temp/site/uploads/default/12345/67890.jpg\",\n  \"external_upload_identifier\": \"84x83tmxy398t3y._Q_z8CoJYVr69bE6D7f8J6Oo0434QquLFoYdGVerWFx9X5HDEI_TP_95c34n853495x35345394.d.ghQ\",\n  \"unique_identifier\": \"66e86218-80d9-4bda-b4d5-2b6def968705\"\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem></ApiTabs></div></div>
      