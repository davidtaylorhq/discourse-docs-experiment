---
id: batch-presign-multipart-parts
title: "Generates batches of presigned URLs for multipart parts"
description: "Multipart uploads are uploaded in chunks or parts to individual presigned"
sidebar_label: "Generates batches of presigned URLs for multipart parts"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "post api-method"
info_path: docs/rest-api/discourse-api-documentation
custom_edit_url: null
hide_send_button: true
---

import ApiTabs from "@theme/ApiTabs";
import DiscriminatorTabs from "@theme/DiscriminatorTabs";
import MethodEndpoint from "@theme/ApiExplorer/MethodEndpoint";
import SecuritySchemes from "@theme/ApiExplorer/SecuritySchemes";
import MimeTabs from "@theme/MimeTabs";
import ParamsItem from "@theme/ParamsItem";
import ResponseSamples from "@theme/ResponseSamples";
import SchemaItem from "@theme/SchemaItem";
import SchemaTabs from "@theme/SchemaTabs";
import Markdown from "@theme/Markdown";
import OperationTabs from "@theme/OperationTabs";
import TabItem from "@theme/TabItem";

<h1 className={"openapi__heading"}>Generates batches of presigned URLs for multipart parts</h1>

<MethodEndpoint method={"post"} path={"/uploads/batch-presign-multipart-parts.json"}></MethodEndpoint>



Multipart uploads are uploaded in chunks or parts to individual presigned
URLs, similar to the one generated by /generate-presigned-put. The part
numbers provided must be between 1 and 10000. The total number of parts
will depend on the chunk size in bytes that you intend to use to upload
each chunk. For example a 12MB file may have 2 5MB chunks and a final
2MB chunk, for part numbers 1, 2, and 3.

This endpoint will return a presigned URL for each part number provided,
which you can then use to send PUT requests for the binary chunk corresponding
to that part. When the part is uploaded, the provider should return an
ETag for the part, and this should be stored along with the part number,
because this is needed to complete the multipart upload.

You must have the correct permissions and CORS settings configured in your
external provider. We support AWS S3 as the default. See:

https://meta.discourse.org/t/-/210469#s3-multipart-direct-uploads-4.

An external file store must be set up and `enable_direct_s3_uploads` must
be set to true for this endpoint to function.



## Request

<MimeTabs className={"openapi-tabs__mime"}><TabItem label={"application/json"} value={"application/json-schema"}><details style={{}} className={"openapi-markdown__details mime"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-mime"}><h3 className={"openapi-markdown__details-summary-header-body"}>Body</h3></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"part_numbers"} required={true} schemaName={"array"} qualifierMessage={undefined} schema={{"type":"array","description":"The part numbers to generate the presigned URLs for, must be between 1 and 10000.","example":[1,2,3]}}></SchemaItem><SchemaItem collapsible={false} name={"unique_identifier"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"The unique identifier returned in the original /create-multipart request.","example":"66e86218-80d9-4bda-b4d5-2b6def968705"}}></SchemaItem></ul></details></TabItem></MimeTabs><div><div><ApiTabs label={undefined} id={undefined}><TabItem label={"200"} value={"200"}><div>

external upload initialized

</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}}></div><ul style={{"marginLeft":"1rem"}}><SchemaItem collapsible={false} name={"presigned_urls"} required={true} schemaName={"object"} qualifierMessage={undefined} schema={{"type":"object","description":"The presigned URLs for each part number, which has the part numbers as keys.","example":{"1":"https://discourse-martin-uploads-test.s3.us-east-2.amazonaws.com/temp/uploads/default/123abc/123abc.jpg?partNumber=1&uploadId=123456abcd&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=test&X-Amz-Date=20211222T012336Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=abc123"}}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"presigned_urls\": {\n    \"1\": \"https://discourse-martin-uploads-test.s3.us-east-2.amazonaws.com/temp/uploads/default/123abc/123abc.jpg?partNumber=1&uploadId=123456abcd&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=test&X-Amz-Date=20211222T012336Z&X-Amz-Expires=600&X-Amz-SignedHeaders=host&X-Amz-Signature=abc123\"\n  }\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem></ApiTabs></div></div>
      